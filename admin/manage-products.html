<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
      crossorigin="anonymous"
    ></script>

    <style>
      .col {
        background-color: red;
      }

      body {
        display: grid;
        grid-template-columns: 1fr 7fr;
      }

      header {
        background-color: rgb(32, 210, 250);
      }
      main {
      }

      .active {
        color: red;
        font-size: 1.2em;
      }
    </style>
  </head>
  <body>
    <header>
      <nav>
        <ul>
          <li><a href="./manage-users.html">User</a></li>
          <li class="active"><a href="./manage-products.html">Products</a></li>
          <li><a href="./manage-orders.html">Orders</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <section id="search-product" class="container">
        <div class="d-flex p-5" role="search">
          <input
            class="form-control me-2"
            type="search"
            placeholder="Search name product"
            aria-label="Search"
            id="input-search"
          />
          <button
            class="btn btn-outline-success"
            type="submit"
            onclick="handleSearch()"
          >
            Search
          </button>
        </div>
      </section>

      <section id="users" class="container">
        <table class="table table-striped">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">ID product</th>
              <th scope="col">Name</th>
              <th scope="col">Price</th>
              <th scope="col">Description</th>
              <th scope="col">Action</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
    </main>

    <!-- Modal  product detail-->
    <div
      class="modal fade"
      id="modal-product-detail-admin"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="staticBackdropLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="staticBackdropLabel">
              Modal title
            </h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script src="../js/method.js"></script>
  <script>
    renderUsers();
    function renderUsers() {
      const tbodyElement = document.querySelector("#users tbody");

      let tbodyContent = "";

      const products = getDataFormLocal("products") ?? [];

      products.forEach((product, index) => {
        tbodyContent += `
        <tr>
              <th scope="row">${index + 1}</th>
              <td>${product.id}</td>
              <td>${product.name}</td>
              <td>${product.price}</td>
              <td>${product.description}</td>
              <td><button data-bs-toggle="modal" data-bs-target="#modal-product-detail-admin" class="btn btn-info " onclick="handleDetail('${
                product.id
              }')">Detail</button><button class="btn btn-primary mx-1" onclick="handleEdit('${
          product.id
        }')">Edit</button><button class="btn btn-danger" onclick="handleDelete('${
          product.id
        }')">Delete</button></td>
              
            </tr>`;
      });
      tbodyElement.innerHTML = tbodyContent;
    }
    function handleDetail(id) {
      console.log(id, 11111);
      const productsDB = getDataFormLocal("products") ?? [];

      // Tìm sản phẩm trong db

      let productDetail;
      for (let index = 0; index < productsDB.length; index++) {
        if (productsDB[index].id == id) {
          productDetail = productsDB[index];
          break;
        }
      }

      if (!productDetail) {
        return;
      }
      //   Render cho modal

      const modalBodyProductDetail = document.querySelector(
        "#modal-product-detail-admin .modal-body"
      );
      const modalBodyContent = `<div class="card">
  <img
    src="${productDetail.imageUrl}"
    class="card-img-top"
    alt="${productDetail.name}"
  />
  <div class="card-body">
    <h5 class="card-title">${productDetail.name}</h5>
    <p class="card-text">${productDetail.description}</p>
    <p class="card-text">Price: $${Number(
      productDetail.price
    ).toLocaleString()}</p>
   
  </div>`;
      modalBodyProductDetail.innerHTML = modalBodyContent;

      btnBuy.setAttribute("onclick", `handleAddToCart('${id}')`);
    }
  </script>
</html>
