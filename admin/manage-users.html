<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
      crossorigin="anonymous"
    ></script>

    <style>
      .col {
        background-color: red;
      }

      body {
        display: grid;
        grid-template-columns: 1fr 7fr;
      }

      header {
        background-color: rgb(32, 210, 250);
      }
      main {
      }

      .active {
        color: red;
        font-size: 1.2em;
      }
    </style>
  </head>
  <body>
    <header>
      <nav>
        <ul>
          <li class="active"><a href="./manage-users.html">User</a></li>
          <li><a href="./manage-products.html">Products</a></li>
          <li><a href="./manage-orders.html">Orders</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <section id="search-product" class="container">
        <div class="d-flex p-5" role="search">
          <input
            class="form-control me-2"
            type="search"
            placeholder="Search name product"
            aria-label="Search"
            id="input-search"
          />
          <button
            class="btn btn-outline-success"
            type="submit"
            onclick="handleSearch()"
          >
            Search
          </button>
        </div>
      </section>

      <section id="users" class="container">
        <table class="table table-striped">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Email</th>
              <th scope="col">Role</th>
              <th scope="col">Status</th>
              <th scope="col">Action</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
    </main>
  </body>
  <script src="../js/method.js"></script>
  <script>
    renderUsers();
    function renderUsers() {
      const tbodyElement = document.querySelector("#users tbody");

      let tbodyContent = "";

      const accounts = getDataFormLocal("accounts") ?? [];

      accounts.forEach((user, index) => {
        tbodyContent += `
        <tr>
              <th scope="row">${index + 1}</th>
              <td>${user.email}</td>
              <td>${user.role}</td>
              <td>${user.isActive ? "Active" : "Inactive"}</td>
              <td><button style="${
                user.role === "admin" ? "display:none" : ""
              }"onclick="handleChangeUser('${user.email}')">Change</button></td>
            </tr>`;
      });
      tbodyElement.innerHTML = tbodyContent;
    }

    function handleChangeUser(email) {
      const accounts = getDataFormLocal("accounts") ?? [];
      for (let index = 0; index < accounts.length; index++) {
        const user = accounts[index];

        if (user.email == email) {
          user.isActive = !user.isActive;
          break;
        }
      }
      setDataToLocal("accounts", accounts);
      renderUsers();
    }
  </script>
</html>
